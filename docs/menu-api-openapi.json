{
  "openapi": "3.0.3",
  "info": {
    "title": "Saturn MouseHunter - èœå•ç®¡ç†API",
    "description": "æœ€å°åŒ–èœå•æ¨¡å—APIï¼Œä¸ºUIå‰ç«¯æä¾›å‡†ç¡®çš„æ¥å£å¯¹æ¥è§„èŒƒ",
    "version": "1.0.0",
    "contact": {
      "name": "Saturn MouseHunter Team",
      "email": "team@saturn-mousehunter.com"
    }
  },
  "servers": [
    {
      "url": "http://localhost:8080/api/v1",
      "description": "å¼€å‘ç¯å¢ƒ"
    },
    {
      "url": "http://192.168.8.168:8001/api/v1",
      "description": "æµ‹è¯•ç¯å¢ƒ"
    }
  ],
  "security": [
    {
      "BearerAuth": []
    }
  ],
  "paths": {
    "/auth/user-menus": {
      "get": {
        "tags": ["èœå•æƒé™"],
        "summary": "è·å–å½“å‰ç”¨æˆ·å¯è®¿é—®çš„èœå•",
        "description": "è¿”å›å½“å‰è®¤è¯ç”¨æˆ·åŸºäºæƒé™è¿‡æ»¤åçš„èœå•æ ‘ç»“æ„",
        "security": [{"BearerAuth": []}],
        "responses": {
          "200": {
            "description": "æˆåŠŸè·å–ç”¨æˆ·èœå•",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserMenuResponse"
                },
                "example": {
                  "user_id": "USER_12345",
                  "user_type": "TENANT",
                  "permissions": ["menu:dashboard", "menu:trading_calendar"],
                  "menus": [
                    {
                      "id": "dashboard",
                      "name": "dashboard",
                      "title": "æ€»è§ˆ",
                      "title_en": "Dashboard",
                      "path": "/",
                      "component": "Dashboard",
                      "icon": "dashboard",
                      "emoji": "ğŸ ",
                      "permission": "menu:dashboard",
                      "menu_type": "menu",
                      "sort_order": 1,
                      "is_hidden": false,
                      "status": "active",
                      "meta": {"keepAlive": true},
                      "children": []
                    }
                  ],
                  "updated_at": "2025-09-20T05:35:50.000Z"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/auth/check-menu-permission": {
      "post": {
        "tags": ["èœå•æƒé™"],
        "summary": "æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æŒ‡å®šèœå•çš„è®¿é—®æƒé™",
        "description": "éªŒè¯å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰è®¿é—®ç‰¹å®šèœå•çš„æƒé™",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {
            "name": "menu_id",
            "in": "query",
            "required": true,
            "description": "è¦æ£€æŸ¥çš„èœå•ID",
            "schema": {
              "type": "string",
              "example": "dashboard"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "æƒé™æ£€æŸ¥ç»“æœ",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MenuPermissionCheck"
                },
                "example": {
                  "menu_id": "dashboard",
                  "permission": "menu:dashboard",
                  "has_permission": true
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/responses/BadRequestError"
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/auth/menu-stats": {
      "get": {
        "tags": ["èœå•æƒé™"],
        "summary": "è·å–å½“å‰ç”¨æˆ·çš„èœå•ç»Ÿè®¡ä¿¡æ¯",
        "description": "è¿”å›ç”¨æˆ·çš„èœå•è®¿é—®ç»Ÿè®¡æ•°æ®ï¼ŒåŒ…æ‹¬æ€»æ•°ã€å¯è®¿é—®æ•°é‡å’Œè¦†ç›–ç‡",
        "security": [{"BearerAuth": []}],
        "responses": {
          "200": {
            "description": "èœå•ç»Ÿè®¡ä¿¡æ¯",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MenuStats"
                },
                "example": {
                  "total_menus": 23,
                  "accessible_menus": 11,
                  "permission_coverage": 47.83,
                  "menu_usage": {
                    "dashboard": 1,
                    "trading_calendar": 1,
                    "proxy_pool": 0
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/menus/tree": {
      "get": {
        "tags": ["èœå•ç®¡ç†"],
        "summary": "è·å–å®Œæ•´èœå•æ ‘ç»“æ„ (ä»…ç®¡ç†å‘˜)",
        "description": "è¿”å›ç³»ç»Ÿä¸­æ‰€æœ‰èœå•çš„å®Œæ•´æ ‘ç»“æ„ï¼Œä¸è¿›è¡Œæƒé™è¿‡æ»¤",
        "security": [{"BearerAuth": ["admin"]}],
        "responses": {
          "200": {
            "description": "å®Œæ•´èœå•æ ‘",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/MenuItem"
                  }
                },
                "example": [
                  {
                    "id": "dashboard",
                    "name": "dashboard",
                    "title": "æ€»è§ˆ",
                    "title_en": "Dashboard",
                    "path": "/",
                    "component": "Dashboard",
                    "icon": "dashboard",
                    "emoji": "ğŸ ",
                    "permission": "menu:dashboard",
                    "menu_type": "menu",
                    "sort_order": 1,
                    "is_hidden": false,
                    "status": "active",
                    "meta": {"keepAlive": true},
                    "children": []
                  }
                ]
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/ForbiddenError"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    },
    "/users/{user_id}/menus": {
      "get": {
        "tags": ["èœå•ç®¡ç†"],
        "summary": "è·å–æŒ‡å®šç”¨æˆ·çš„å¯è®¿é—®èœå• (ä»…ç®¡ç†å‘˜)",
        "description": "ç®¡ç†å‘˜æŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„èœå•æƒé™ï¼Œæˆ–ç”¨æˆ·æŸ¥çœ‹è‡ªå·±çš„èœå•",
        "security": [{"BearerAuth": []}],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "description": "ç›®æ ‡ç”¨æˆ·ID",
            "schema": {
              "type": "string",
              "example": "USER_12345"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "æŒ‡å®šç”¨æˆ·çš„èœå•æ•°æ®",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserMenuResponse"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/UnauthorizedError"
          },
          "403": {
            "$ref": "#/components/responses/ForbiddenError"
          },
          "404": {
            "$ref": "#/components/responses/NotFoundError"
          },
          "500": {
            "$ref": "#/components/responses/InternalServerError"
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "MenuItem": {
        "type": "object",
        "required": ["id", "name", "title", "menu_type", "sort_order", "is_hidden", "status"],
        "properties": {
          "id": {
            "type": "string",
            "description": "èœå•å”¯ä¸€ID",
            "example": "dashboard"
          },
          "name": {
            "type": "string",
            "description": "èœå•åç§°",
            "example": "dashboard"
          },
          "title": {
            "type": "string",
            "description": "æ˜¾ç¤ºæ ‡é¢˜ï¼ˆä¸­æ–‡ï¼‰",
            "example": "æ€»è§ˆ"
          },
          "title_en": {
            "type": "string",
            "description": "è‹±æ–‡æ ‡é¢˜",
            "example": "Dashboard",
            "nullable": true
          },
          "path": {
            "type": "string",
            "description": "è·¯ç”±è·¯å¾„",
            "example": "/",
            "nullable": true
          },
          "component": {
            "type": "string",
            "description": "ç»„ä»¶åç§°",
            "example": "Dashboard",
            "nullable": true
          },
          "icon": {
            "type": "string",
            "description": "å›¾æ ‡ç±»å",
            "example": "dashboard",
            "nullable": true
          },
          "emoji": {
            "type": "string",
            "description": "è¡¨æƒ…å›¾æ ‡",
            "example": "ğŸ ",
            "nullable": true
          },
          "parent_id": {
            "type": "string",
            "description": "çˆ¶èœå•ID",
            "example": "user_management",
            "nullable": true
          },
          "permission": {
            "type": "string",
            "description": "æ‰€éœ€æƒé™",
            "example": "menu:dashboard",
            "nullable": true
          },
          "menu_type": {
            "type": "string",
            "enum": ["menu", "button", "tab"],
            "description": "èœå•ç±»å‹",
            "example": "menu"
          },
          "sort_order": {
            "type": "integer",
            "description": "æ’åºå€¼",
            "example": 1
          },
          "is_hidden": {
            "type": "boolean",
            "description": "æ˜¯å¦éšè—",
            "example": false
          },
          "is_external": {
            "type": "boolean",
            "description": "æ˜¯å¦å¤–éƒ¨é“¾æ¥",
            "example": false,
            "nullable": true
          },
          "status": {
            "type": "string",
            "enum": ["active", "disabled"],
            "description": "èœå•çŠ¶æ€",
            "example": "active"
          },
          "meta": {
            "type": "object",
            "description": "å…ƒæ•°æ®",
            "additionalProperties": true,
            "example": {"keepAlive": true},
            "nullable": true
          },
          "children": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MenuItem"
            },
            "description": "å­èœå•",
            "nullable": true
          }
        }
      },
      "UserMenuResponse": {
        "type": "object",
        "required": ["user_id", "user_type", "permissions", "menus", "updated_at"],
        "properties": {
          "user_id": {
            "type": "string",
            "description": "ç”¨æˆ·ID",
            "example": "USER_12345"
          },
          "user_type": {
            "type": "string",
            "enum": ["ADMIN", "TENANT", "LIMITED"],
            "description": "ç”¨æˆ·ç±»å‹",
            "example": "TENANT"
          },
          "permissions": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "ç”¨æˆ·æƒé™åˆ—è¡¨",
            "example": ["menu:dashboard", "menu:trading_calendar"]
          },
          "menus": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MenuItem"
            },
            "description": "å¯è®¿é—®èœå•æ ‘"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "æ›´æ–°æ—¶é—´ï¼ˆISOæ ¼å¼ï¼‰",
            "example": "2025-09-20T05:35:50.000Z"
          }
        }
      },
      "MenuPermissionCheck": {
        "type": "object",
        "required": ["menu_id", "permission", "has_permission"],
        "properties": {
          "menu_id": {
            "type": "string",
            "description": "èœå•ID",
            "example": "dashboard"
          },
          "permission": {
            "type": "string",
            "description": "æ‰€éœ€æƒé™",
            "example": "menu:dashboard"
          },
          "has_permission": {
            "type": "boolean",
            "description": "æ˜¯å¦æœ‰æƒé™",
            "example": true
          }
        }
      },
      "MenuStats": {
        "type": "object",
        "required": ["total_menus", "accessible_menus", "permission_coverage", "menu_usage"],
        "properties": {
          "total_menus": {
            "type": "integer",
            "description": "èœå•æ€»æ•°",
            "example": 23
          },
          "accessible_menus": {
            "type": "integer",
            "description": "å¯è®¿é—®èœå•æ•°",
            "example": 11
          },
          "permission_coverage": {
            "type": "number",
            "format": "float",
            "description": "æƒé™è¦†ç›–ç‡ï¼ˆ0-100ï¼‰",
            "example": 47.83
          },
          "menu_usage": {
            "type": "object",
            "additionalProperties": {
              "type": "integer"
            },
            "description": "èœå•ä½¿ç”¨ç»Ÿè®¡",
            "example": {
              "dashboard": 1,
              "trading_calendar": 1,
              "proxy_pool": 0
            }
          }
        }
      },
      "APIError": {
        "type": "object",
        "required": ["detail", "status_code"],
        "properties": {
          "detail": {
            "type": "string",
            "description": "é”™è¯¯æè¿°ä¿¡æ¯"
          },
          "status_code": {
            "type": "integer",
            "description": "HTTPçŠ¶æ€ç "
          }
        }
      }
    },
    "responses": {
      "BadRequestError": {
        "description": "è¯·æ±‚å‚æ•°é”™è¯¯",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/APIError"
            },
            "example": {
              "detail": "ç¼ºå°‘å¿…éœ€çš„å‚æ•°: menu_id",
              "status_code": 400
            }
          }
        }
      },
      "UnauthorizedError": {
        "description": "æœªè®¤è¯æˆ–tokenè¿‡æœŸ",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/APIError"
            },
            "example": {
              "detail": "æœªè®¤è¯æˆ–tokenå·²è¿‡æœŸ",
              "status_code": 401
            }
          }
        }
      },
      "ForbiddenError": {
        "description": "æƒé™ä¸è¶³",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/APIError"
            },
            "example": {
              "detail": "åªæœ‰ç®¡ç†å‘˜å¯ä»¥è®¿é—®æ­¤èµ„æº",
              "status_code": 403
            }
          }
        }
      },
      "NotFoundError": {
        "description": "èµ„æºä¸å­˜åœ¨",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/APIError"
            },
            "example": {
              "detail": "ç”¨æˆ·ä¸å­˜åœ¨",
              "status_code": 404
            }
          }
        }
      },
      "InternalServerError": {
        "description": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/APIError"
            },
            "example": {
              "detail": "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•",
              "status_code": 500
            }
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "èœå•æƒé™",
      "description": "ç”¨æˆ·èœå•æƒé™ç›¸å…³æ¥å£"
    },
    {
      "name": "èœå•ç®¡ç†",
      "description": "èœå•ç®¡ç†ç›¸å…³æ¥å£ï¼ˆç®¡ç†å‘˜åŠŸèƒ½ï¼‰"
    }
  ]
}